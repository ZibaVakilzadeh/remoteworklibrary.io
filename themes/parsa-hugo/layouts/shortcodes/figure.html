<figure{{ with .Get "class" }} class="{{ . }}"{{ end }}>
  {{ .Inner }}
  {{- if or (or (.Get "title") (.Get "figcaption")) (.Get "attr") -}}
    <figcaption>
      {{ with (.Get "title") -}}
        <h4>{{ . }}</h4>
      {{- end -}}
      {{- if or (.Get "figcaption") (.Get "attr") -}}
        <p>
          {{- .Get "figcaption" | markdownify -}}
          {{- with .Get "attrlink" }}<a href="{{ . }}">{{- end -}}
          {{- .Get "attr" | markdownify -}}
          {{- if .Get "attrlink" }}</a>{{ end }}
        </p>
      {{- end }}
    </figcaption>
  {{- end }}
</figure>